@startuml C4_Component
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml
title SKill Monolito

Container(ask, "Alexa Skills Kit", "Runtime", "Entrega intents/slots en JSON")

Container_Boundary(lambda, "Lambda Function (Python)") {
  Component(launch, "LaunchRequestHandler", "Clase", "Da la bienvenida al skill")
  Component(add, "AgregarLibroIntentHandler", "Clase", "Agrega un libro con título/autor/tipo")
  Component(listar, "ListarLibrosIntentHandler", "Clase", "Lista libros disponibles, prestados o todos")
  Component(buscar, "BuscarLibroIntentHandler", "Clase", "Busca libro por título")
  Component(prestar, "PrestarLibroIntentHandler", "Clase", "Registra préstamo de libro a persona")
  Component(devolver, "DevolverLibroIntentHandler", "Clase", "Marca libro como devuelto")
  Component(eliminar, "EliminarLibroIntentHandler", "Clase", "Elimina un libro de la colección")
  Component(prestamos, "ConsultarPrestamosIntentHandler", "Clase", "Consulta libros prestados")
  Component(devueltos, "ConsultarDevueltosIntentHandler", "Clase", "Consulta historial de devueltos")
  Component(skillbuilder, "SkillBuilder", "ASK SDK", "Registra handlers y configura el skill")
  Component(utils, "Utils.py", "Funciones", "Soporte para URLs S3 y helpers")
  Component(s3adapter, "S3Adapter/FakeS3", "Clase", "Persistencia en Amazon S3")
}

ContainerDb(s3, "Amazon S3", "JSON", "Almacenamiento de atributos de usuario")

Rel(ask, launch, "LaunchRequest", "JSON")
Rel(ask, add, "AgregarLibroIntent", "JSON")
Rel(ask, eliminar, "EliminarLibroIntent", "JSON")
Rel(ask, listar, "ListarLibrosIntent", "JSON")
Rel(ask, buscar, "BuscarLibroIntent", "JSON")
Rel(ask, prestar, "PrestarLibroIntent", "JSON")
Rel(ask, devolver, "DevolverLibroIntent", "JSON")
Rel(ask, prestamos, "ConsultarPrestamosIntent", "JSON")
Rel(ask, devueltos, "ConsultarDevueltosIntent", "JSON")

Rel(add, s3adapter, "Guardar libro", "PutObject")
Rel(listar, s3adapter, "Leer libros", "GetObject")
Rel(buscar, s3adapter, "Buscar libro", "GetObject")
Rel(prestar, s3adapter, "Actualizar estado", "PutObject")
Rel(devolver, s3adapter, "Actualizar estado", "PutObject")
Rel(eliminar, s3adapter, "Eliminar libro", "DeleteObject")

Rel(s3adapter, s3, "CRUD objetos JSON", "AWS SDK")
@enduml